{"paragraphs":[{"text":"%md\n\n# RDD to DataFrame\n\n- Similar to RDDs, DataFrames are immutable and distributed data structures in Spark. Even though RDDs are a fundamental data structure in Spark, working with data in DataFrame is easier than RDD most of the time and so understanding of how to convert RDD to DataFrame is necessary.\n\n- In this exercise, you'll first make an RDD using the `sample_list` which contains the list of tuples `('Mona',20), ('Jennifer',34),('John',20), ('Jim',26)` with each tuple contains the name of the person and their age. Next, you'll create a DataFrame using the RDD and the schema (which is the list of `'Name'` and `'Age'`) and finally confirm the output as PySpark DataFrame.\n\n- Remember, you already have a `SparkContext` `sc` and `SparkSession` `spark` available in your workspace.\n\n## Instructions\n- Create a `sample_list` from tuples - `('Mona',20), ('Jennifer',34), ('John',20), ('Jim',26)`.\n- Create an RDD from the `sample_list`.\n- Create a PySpark DataFrame using the above RDD and schema.\n- Confirm the output as PySpark DataFrame.","user":"anonymous","dateUpdated":"2021-03-01T11:22:40+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>RDD to DataFrame</h1>\n<ul>\n  <li>\n  <p>Similar to RDDs, DataFrames are immutable and distributed data structures in Spark. Even though RDDs are a fundamental data structure in Spark, working with data in DataFrame is easier than RDD most of the time and so understanding of how to convert RDD to DataFrame is necessary.</p></li>\n  <li>\n  <p>In this exercise, you&rsquo;ll first make an RDD using the <code>sample_list</code> which contains the list of tuples <code>(&#39;Mona&#39;,20), (&#39;Jennifer&#39;,34),(&#39;John&#39;,20), (&#39;Jim&#39;,26)</code> with each tuple contains the name of the person and their age. Next, you&rsquo;ll create a DataFrame using the RDD and the schema (which is the list of <code>&#39;Name&#39;</code> and <code>&#39;Age&#39;</code>) and finally confirm the output as PySpark DataFrame.</p></li>\n  <li>\n  <p>Remember, you already have a <code>SparkContext</code> <code>sc</code> and <code>SparkSession</code> <code>spark</code> available in your workspace.</p></li>\n</ul>\n<h2>Instructions</h2>\n<ul>\n  <li>Create a <code>sample_list</code> from tuples - <code>(&#39;Mona&#39;,20), (&#39;Jennifer&#39;,34), (&#39;John&#39;,20), (&#39;Jim&#39;,26)</code>.</li>\n  <li>Create an RDD from the <code>sample_list</code>.</li>\n  <li>Create a PySpark DataFrame using the above RDD and schema.</li>\n  <li>Confirm the output as PySpark DataFrame.</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1614577922250_1518085739","id":"20201113-110338_1928025495","dateCreated":"2021-03-01T11:22:02+0530","dateStarted":"2021-03-01T11:22:40+0530","dateFinished":"2021-03-01T11:22:41+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:773"},{"text":"%pyspark\n\n# Create a list of tuples\nsample_list = [('Mona',20), ('Jennifer',34), ('John',20), ('Jim',27)]\n\n# Create a RDD from the list\nrdd = sc.____(sample_list)\n\n# Create a PySpark DataFrame\nnames_df = spark.createDataFrame(____, ____=['Name', 'Age'])\n\n# Check the type of names_df\nprint(\"The type of names_df is\", ____(names_df))","user":"anonymous","dateUpdated":"2021-03-01T11:23:34+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614577922283_-403034046","id":"20201113-133413_165094595","dateCreated":"2021-03-01T11:22:02+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:774"},{"text":"%pyspark\n\nsample_list = [('Mona',20), ('Jennifer',34), ('John',20), ('Jim',27)]\nrdd = sc.parallelize(sample_list)\nnames_df = spark.createDataFrame(rdd, schema=['Name','Age'])\n\nprint(names_df.printSchema())\nprint(\"The type of names_df is\", type(names_df))","user":"anonymous","dateUpdated":"2021-03-01T11:37:20+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Name: string (nullable = true)\n |-- Age: long (nullable = true)\n\nNone\nThe type of names_df is <class 'pyspark.sql.dataframe.DataFrame'>\n"}]},"apps":[],"jobName":"paragraph_1614578005538_-1161896649","id":"20210301-112325_377063376","dateCreated":"2021-03-01T11:23:25+0530","dateStarted":"2021-03-01T11:37:20+0530","dateFinished":"2021-03-01T11:37:21+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:775"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-01T11:25:47+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614578147590_-744422825","id":"20210301-112547_1549021840","dateCreated":"2021-03-01T11:25:47+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:776"}],"name":"/BDFWithPySpark/M3/SM1/Ex1","id":"2FY86VUGX","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}