{"paragraphs":[{"text":"%pyspark\n\nRDD_split = sc.textFile('file:////home/talentum/shared_BDVM/spark/PairRdd_challange_lab/selfishgiant.txt').flatMap(lambda line : line.split(\" \"))\n\nprint(RDD_split.take(7))","user":"anonymous","dateUpdated":"2021-02-28T16:49:30+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['EVERY', 'afternoon,', 'as', 'they', 'were', 'coming', 'from']\n"}]},"apps":[],"jobName":"paragraph_1614510276340_-143208948","id":"20210228-163436_2088714099","dateCreated":"2021-02-28T16:34:36+0530","dateStarted":"2021-02-28T16:49:30+0530","dateFinished":"2021-02-28T16:49:31+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4212"},{"text":"%pyspark\n\nRDD_mapped = RDD_split.map(lambda word : (word, 1))\n\nprint(RDD_mapped.take(7))","user":"anonymous","dateUpdated":"2021-02-28T16:56:33+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('EVERY', 1), ('afternoon,', 1), ('as', 1), ('they', 1), ('were', 1), ('coming', 1), ('from', 1)]\n"}]},"apps":[],"jobName":"paragraph_1614510984472_1366654275","id":"20210228-164624_1955841956","dateCreated":"2021-02-28T16:46:24+0530","dateStarted":"2021-02-28T16:56:33+0530","dateFinished":"2021-02-28T16:56:33+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4213"},{"text":"%pyspark\n\nmonths = (\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\")\nRDD_months = sc.parallelize(months)\n\n# creating index via zip\nRDD_monthsIndexed_0 = RDD_months.zipWithIndex()\nprint(type(RDD_monthsIndexed_0))\nprint(RDD_monthsIndexed_0.collect())","user":"anonymous","dateUpdated":"2021-02-28T17:08:55+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.rdd.PipelinedRDD'>\n[('Jan', 0), ('Feb', 1), ('Mar', 2), ('Apr', 3), ('May', 4), ('Jun', 5), ('Jul', 6)]\n"}]},"apps":[],"jobName":"paragraph_1614511593127_1096960502","id":"20210228-165633_1245044385","dateCreated":"2021-02-28T16:56:33+0530","dateStarted":"2021-02-28T17:07:04+0530","dateFinished":"2021-02-28T17:07:05+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4214"},{"text":"%pyspark\n\n# this is how we can control over values (.mapValues())\nRDD_monthsIndexed_1 = RDD_monthsIndexed_0.mapValues(lambda x : x+1)\n\n# alter way\n# RDD_monthsIndexed_1 = RDD_monthsIndexed_0.map(lambda x : (x[0], x[1]+1))\n\nprint(RDD_monthsIndexed_1.collect())","user":"anonymous","dateUpdated":"2021-02-28T17:48:18+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Jan', 1), ('Feb', 2), ('Mar', 3), ('Apr', 4), ('May', 5), ('Jun', 6), ('Jul', 7)]\n"}]},"apps":[],"jobName":"paragraph_1614512177992_-1741035607","id":"20210228-170617_1167954055","dateCreated":"2021-02-28T17:06:17+0530","dateStarted":"2021-02-28T17:48:02+0530","dateFinished":"2021-02-28T17:48:03+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4215"},{"text":"%pyspark\n\nquarters =(1,1,1,2,2,2,3)\nRDD_quarters = sc.parallelize(quarters)\nRDD_monthsZipQuarters = RDD_months.zip(RDD_quarters)\nprint(RDD_monthsZipQuarters.collect())","user":"anonymous","dateUpdated":"2021-02-28T17:31:00+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Jan', 1), ('Feb', 1), ('Mar', 1), ('Apr', 2), ('May', 2), ('Jun', 2), ('Jul', 3)]\n"}]},"apps":[],"jobName":"paragraph_1614512449935_1515399404","id":"20210228-171049_1771510667","dateCreated":"2021-02-28T17:10:49+0530","dateStarted":"2021-02-28T17:31:00+0530","dateFinished":"2021-02-28T17:31:01+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4216"},{"text":"%pyspark\n\nprint(RDD_monthsZipQuarters.keys().collect())\nprint(RDD_monthsZipQuarters.values().collect())\nprint(RDD_monthsZipQuarters.sortByKey().collect())","user":"anonymous","dateUpdated":"2021-02-28T17:32:27+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul']\n[1, 1, 1, 2, 2, 2, 3]\n[('Apr', 2), ('Feb', 1), ('Jan', 1), ('Jul', 3), ('Jun', 2), ('Mar', 1), ('May', 2)]\n"}]},"apps":[],"jobName":"paragraph_1614513660397_2082059011","id":"20210228-173100_509846396","dateCreated":"2021-02-28T17:31:00+0530","dateStarted":"2021-02-28T17:32:27+0530","dateFinished":"2021-02-28T17:32:28+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4217"},{"text":"%pyspark\n\nprint(RDD_mapped.take(7))\n\nRDD_reduceByKey = RDD_mapped.reduceByKey(lambda x,y : x+y)\nprint(RDD_reduceByKey.take(7))\n\n# so it is not depending upon take","user":"anonymous","dateUpdated":"2021-02-28T18:00:12+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('EVERY', 1), ('afternoon,', 1), ('as', 1), ('they', 1), ('were', 1), ('coming', 1), ('from', 1)]\n[('EVERY', 1), ('afternoon,', 3), ('as', 9), ('they', 17), ('were', 21), ('coming', 1), ('from', 3)]\n"}]},"apps":[],"jobName":"paragraph_1614513747355_291506588","id":"20210228-173227_356615489","dateCreated":"2021-02-28T17:32:27+0530","dateStarted":"2021-02-28T17:44:37+0530","dateFinished":"2021-02-28T17:44:39+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4218"},{"text":"%pyspark\n\nRDD_flipped = RDD_reduceByKey.map(lambda x : (x[1], x[0]))\nprint(RDD_flipped.take(7))","user":"anonymous","dateUpdated":"2021-02-28T18:02:28+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 'EVERY'), (3, 'afternoon,'), (9, 'as'), (17, 'they'), (21, 'were'), (1, 'coming'), (3, 'from')]\n"}]},"apps":[],"jobName":"paragraph_1614514276418_273226498","id":"20210228-174116_1832013072","dateCreated":"2021-02-28T17:41:16+0530","dateStarted":"2021-02-28T18:02:28+0530","dateFinished":"2021-02-28T18:02:30+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4219"},{"text":"%pyspark\n\nRDD_ordered = RDD_flipped.sortByKey(ascending=False)\nprint(RDD_ordered.take(7))","user":"anonymous","dateUpdated":"2021-02-28T18:07:10+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(148, 'the'), (85, 'and'), (44, 'he'), (38, 'to'), (33, ''), (32, 'was'), (28, 'in')]\n"}]},"apps":[],"jobName":"paragraph_1614515548656_-1982357695","id":"20210228-180228_1764770204","dateCreated":"2021-02-28T18:02:28+0530","dateStarted":"2021-02-28T18:07:11+0530","dateFinished":"2021-02-28T18:07:12+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4220"},{"text":"%md\n\n## challenge\n","user":"anonymous","dateUpdated":"2021-02-28T18:09:16+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>challenge</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1614515830938_-1154494120","id":"20210228-180710_783402665","dateCreated":"2021-02-28T18:07:10+0530","dateStarted":"2021-02-28T18:09:16+0530","dateFinished":"2021-02-28T18:09:21+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4221"},{"text":"%sh\n\nhdfs dfs -mkdir -p /user/zeppelin\nhdfs dfs -put /home/talentum/shared_BDVM/spark/PairRdd_challange_lab/flights.csv /user/zeppelin/\nhdfs dfs -ls /user/zeppelin/","user":"anonymous","dateUpdated":"2021-02-28T18:24:25+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 1 items\n-rw-r--r--   1 talentum supergroup  136035258 2021-02-28 18:24 /user/zeppelin/flights.csv\n"}]},"apps":[],"jobName":"paragraph_1614515956738_-805479520","id":"20210228-180916_659729586","dateCreated":"2021-02-28T18:09:16+0530","dateStarted":"2021-02-28T18:23:40+0530","dateFinished":"2021-02-28T18:24:12+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4222"},{"text":"%pyspark\n\n# from hdfs\nRDD_carrier = sc.textFile('/user/zeppelin/flights.csv').map(lambda val : val.split(',')).map(lambda column : (column[5],1))\nprint(RDD_carrier.take(7))","user":"anonymous","dateUpdated":"2021-02-28T18:37:13+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('WN', 1), ('WN', 1), ('WN', 1), ('WN', 1), ('WN', 1), ('WN', 1), ('WN', 1)]\n"}]},"apps":[],"jobName":"paragraph_1614516390251_-168693838","id":"20210228-181630_724287701","dateCreated":"2021-02-28T18:16:30+0530","dateStarted":"2021-02-28T18:37:13+0530","dateFinished":"2021-02-28T18:37:14+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4223"},{"text":"%pyspark\n\nRDD_carrierSorted = RDD_carrier.reduceByKey(lambda x,y: x+y).map(lambda x: (x[1],x[0])).sortByKey(ascending = False)\nprint(RDD_carrierSorted.take(7))","user":"anonymous","dateUpdated":"2021-02-28T18:44:57+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(356167, 'WN'), (175969, 'AA'), (166445, 'OO'), (141178, 'MQ'), (133403, 'US'), (133303, 'DL'), (131373, 'UA')]\n"}]},"apps":[],"jobName":"paragraph_1614517244787_606631691","id":"20210228-183044_1039932245","dateCreated":"2021-02-28T18:30:44+0530","dateStarted":"2021-02-28T18:44:57+0530","dateFinished":"2021-02-28T18:45:17+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4224"},{"text":"%sh\n\nhdfs dfs -put /home/talentum/shared_BDVM/spark/PairRdd_challange_lab/airports.csv /user/zeppelin/\nhdfs dfs -ls /user/zeppelin/","user":"anonymous","dateUpdated":"2021-02-28T18:46:24+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 2 items\n-rw-r--r--   1 talentum supergroup     205888 2021-02-28 18:46 /user/zeppelin/airports.csv\n-rw-r--r--   1 talentum supergroup  136035258 2021-02-28 18:24 /user/zeppelin/flights.csv\n"}]},"apps":[],"jobName":"paragraph_1614517946433_532059931","id":"20210228-184226_424069777","dateCreated":"2021-02-28T18:42:26+0530","dateStarted":"2021-02-28T18:46:24+0530","dateFinished":"2021-02-28T18:46:36+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4225"},{"text":"%pyspark\n\nRDD_city = sc.textFile(\"/user/zeppelin/airports.csv\").map(lambda val: val.split(\",\")).map(lambda column: (column[0], column[2]))\nprint(RDD_city.take(7))","user":"anonymous","dateUpdated":"2021-02-28T18:48:26+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('iata', 'city'), ('00M', 'BaySprings'), ('00R', 'Livingston'), ('00V', 'ColoradoSprings'), ('01G', 'Perry'), ('01J', 'Hilliard'), ('01M', 'Belmont')]\n"}]},"apps":[],"jobName":"paragraph_1614518184795_-2003947296","id":"20210228-184624_1786628835","dateCreated":"2021-02-28T18:46:24+0530","dateStarted":"2021-02-28T18:48:26+0530","dateFinished":"2021-02-28T18:48:27+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4226"},{"text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-02-28T18:48:43+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614518293880_1683557975","id":"20210228-184813_1162128420","dateCreated":"2021-02-28T18:48:13+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4227"}],"name":"Task_pairRDDs","id":"2FZYM9WQQ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}