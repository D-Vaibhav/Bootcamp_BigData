{"paragraphs":[{"text":"%md\n\n# CountingBykeys\n\n- For many datasets, it is important to count the number of keys in a key/value dataset. For example, counting the number of countries where the product was sold or to show the most popular baby names. In this simple exercise, you'll use the `Rdd` pair RDD that you created earlier and count the number of unique keys in that pair RDD.\n\n- Remember, you already have a SparkContext sc and `Rdd` available in your workspace.\n\n## Instructions\n- Use the `countByKey()` action on the `Rdd` to count the unique keys and assign the result to a variable `total`.\n- What is the type of `total`?\n- Iterate over the `total` and print the keys and their counts.","user":"anonymous","dateUpdated":"2021-02-26T15:22:39+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>CountingBykeys</h1>\n<ul>\n  <li>\n  <p>For many datasets, it is important to count the number of keys in a key/value dataset. For example, counting the number of countries where the product was sold or to show the most popular baby names. In this simple exercise, you&rsquo;ll use the <code>Rdd</code> pair RDD that you created earlier and count the number of unique keys in that pair RDD.</p></li>\n  <li>\n  <p>Remember, you already have a SparkContext sc and <code>Rdd</code> available in your workspace.</p></li>\n</ul>\n<h2>Instructions</h2>\n<ul>\n  <li>Use the <code>countByKey()</code> action on the <code>Rdd</code> to count the unique keys and assign the result to a variable <code>total</code>.</li>\n  <li>What is the type of <code>total</code>?</li>\n  <li>Iterate over the <code>total</code> and print the keys and their counts.</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1614333119204_-1789544185","id":"20201113-110338_1928025495","dateCreated":"2021-02-26T15:21:59+0530","dateStarted":"2021-02-26T15:22:39+0530","dateFinished":"2021-02-26T15:22:39+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10442"},{"text":"%pyspark\n\ndataset = [(1, 2), (3, 4), (3, 6), (4, 5)]\nRdd = sc.parallelize(dataset)\n\n# Transform the rdd with countByKey()\ntotal = Rdd.____()\n\n# What is the type of total?\nprint(\"The type of total is\", type(____))\n\n# Iterate over the total and print the output\nfor k, v in total.____(): \n  print(\"key\", ____, \"has\", ____, \"counts\")","user":"anonymous","dateUpdated":"2021-02-26T15:21:59+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614333119204_-685549323","id":"20201113-133413_165094595","dateCreated":"2021-02-26T15:21:59+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10443"},{"text":"%pyspark\n\ndataset = [(1, 2), (3, 4), (3, 6), (4, 5)]\nRdd = sc.parallelize(dataset)\n\ntotal = Rdd.countByKey()\n\nprint(\"The type of total is\", type(total))\n\nfor k, v in total.items(): \n  print(\"key\", k, \"has\", v, \"counts\")\n","user":"anonymous","dateUpdated":"2021-02-26T15:24:59+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"The type of total is <class 'collections.defaultdict'>\nkey 1 has 1 counts\nkey 3 has 2 counts\nkey 4 has 1 counts\n"}]},"apps":[],"jobName":"paragraph_1614333166906_411103564","id":"20210226-152246_850001588","dateCreated":"2021-02-26T15:22:46+0530","dateStarted":"2021-02-26T15:25:00+0530","dateFinished":"2021-02-26T15:25:00+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10444"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-02-26T15:24:59+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614333299905_-1438347157","id":"20210226-152459_1938694949","dateCreated":"2021-02-26T15:24:59+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:10445"}],"name":"/BDFWithPySpark/M2/SM4/Ex1","id":"2FXQCNXCQ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}