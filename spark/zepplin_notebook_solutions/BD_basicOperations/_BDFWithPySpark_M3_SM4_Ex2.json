{"paragraphs":[{"text":"%md\n\n# Part 1: Create a DataFrame from CSV file\n\n- Every 4 years, the soccer fans throughout the world celebrates a festival called “Fifa World Cup” and with that, everything seems to change in many countries. In this 3 part exercise, you'll be doing some exploratory data analysis (EDA) on the \"FIFA 2018 World Cup Player\" dataset using PySpark SQL which involve DataFrame operations, SQL queries and visualization.\n\n- In the first part, you'll load FIFA 2018 World Cup Players dataset (`Fifa2018_dataset.csv`) which is in CSV format into a PySpark's dataFrame and inspect the data using basic DataFrame operations.\n\n- Remember, you already have `SparkSession` `spark` and `file_path` variable (which is the path to the `Fifa2018_dataset.csv` file) available in your workspace.\n\n## Instructions\n- Create a PySpark DataFrame from `file_path` which is the path to the `Fifa2018_dataset.csv` file.\n- Print the schema of the DataFrame.\n- Print the first 10 observations.\n- How many rows are in there in the DataFrame?","user":"anonymous","dateUpdated":"2021-03-01T15:23:51+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Part 1: Create a DataFrame from CSV file</h1>\n<ul>\n  <li>\n  <p>Every 4 years, the soccer fans throughout the world celebrates a festival called “Fifa World Cup” and with that, everything seems to change in many countries. In this 3 part exercise, you&rsquo;ll be doing some exploratory data analysis (EDA) on the &ldquo;FIFA 2018 World Cup Player&rdquo; dataset using PySpark SQL which involve DataFrame operations, SQL queries and visualization.</p></li>\n  <li>\n  <p>In the first part, you&rsquo;ll load FIFA 2018 World Cup Players dataset (<code>Fifa2018_dataset.csv</code>) which is in CSV format into a PySpark&rsquo;s dataFrame and inspect the data using basic DataFrame operations.</p></li>\n  <li>\n  <p>Remember, you already have <code>SparkSession</code> <code>spark</code> and <code>file_path</code> variable (which is the path to the <code>Fifa2018_dataset.csv</code> file) available in your workspace.</p></li>\n</ul>\n<h2>Instructions</h2>\n<ul>\n  <li>Create a PySpark DataFrame from <code>file_path</code> which is the path to the <code>Fifa2018_dataset.csv</code> file.</li>\n  <li>Print the schema of the DataFrame.</li>\n  <li>Print the first 10 observations.</li>\n  <li>How many rows are in there in the DataFrame?</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1614592058347_-649030950","id":"20201113-110338_1928025495","dateCreated":"2021-03-01T15:17:38+0530","dateStarted":"2021-03-01T15:23:51+0530","dateFinished":"2021-03-01T15:23:51+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7455"},{"text":"%pyspark\n\nfile_path = \"file:////home/talentum/shared_BDVM/spark/DataSet/Fifa2018_dataset.csv\"\n\n# Load the Dataframe\nfifa_df = spark.read.csv(____, header=True, inferSchema=True)\n\n# Check the schema of columns\nfifa_df.____()\n\n# Show the first 10 observations\nfifa_df.____(____)\n\n# Print the total number of rows\nprint(\"There are {} rows in the fifa_df DataFrame\".format(fifa_df.____()))","user":"anonymous","dateUpdated":"2021-03-01T15:25:45+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614592058358_-247710898","id":"20201113-133413_165094595","dateCreated":"2021-03-01T15:17:38+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7456"},{"text":"","user":"anonymous","dateUpdated":"2021-03-01T15:28:59+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614592556071_2019469054","id":"20210301-152556_994681646","dateCreated":"2021-03-01T15:25:56+0530","dateStarted":"2021-03-01T15:27:16+0530","dateFinished":"2021-03-01T15:27:21+0530","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7457"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-01T15:28:50+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614592730746_1462045009","id":"20210301-152850_815377936","dateCreated":"2021-03-01T15:28:50+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:7458"},{"text":"%pyspark\n\nfile_path = \"file:////home/talentum/shared_BDVM/spark/DataSet/Fifa2018_dataset.csv\"\n\n# Load the Dataframe\nfifa_df = spark.read.csv(file_path, header=True, inferSchema=True)\n\nfifa_df.printSchema()\n\nfifa_df.show(10)\n\nprint(\"There are {} rows in the fifa_df DataFrame\".format(fifa_df.count()))","user":"anonymous","dateUpdated":"2021-03-01T15:29:01+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _c0: integer (nullable = true)\n |-- Name: string (nullable = true)\n |-- Age: integer (nullable = true)\n |-- Photo: string (nullable = true)\n |-- Nationality: string (nullable = true)\n |-- Flag: string (nullable = true)\n |-- Overall: integer (nullable = true)\n |-- Potential: integer (nullable = true)\n |-- Club: string (nullable = true)\n |-- Club Logo: string (nullable = true)\n |-- Value: string (nullable = true)\n |-- Wage: string (nullable = true)\n |-- Special: integer (nullable = true)\n |-- Acceleration: string (nullable = true)\n |-- Aggression: string (nullable = true)\n |-- Agility: string (nullable = true)\n |-- Balance: string (nullable = true)\n |-- Ball control: string (nullable = true)\n |-- Composure: string (nullable = true)\n |-- Crossing: string (nullable = true)\n |-- Curve: string (nullable = true)\n |-- Dribbling: string (nullable = true)\n |-- Finishing: string (nullable = true)\n |-- Free kick accuracy: string (nullable = true)\n |-- GK diving: string (nullable = true)\n |-- GK handling: string (nullable = true)\n |-- GK kicking: string (nullable = true)\n |-- GK positioning: string (nullable = true)\n |-- GK reflexes: string (nullable = true)\n |-- Heading accuracy: string (nullable = true)\n |-- Interceptions: string (nullable = true)\n |-- Jumping: string (nullable = true)\n |-- Long passing: string (nullable = true)\n |-- Long shots: string (nullable = true)\n |-- Marking: string (nullable = true)\n |-- Penalties: string (nullable = true)\n |-- Positioning: string (nullable = true)\n |-- Reactions: string (nullable = true)\n |-- Short passing: string (nullable = true)\n |-- Shot power: string (nullable = true)\n |-- Sliding tackle: string (nullable = true)\n |-- Sprint speed: string (nullable = true)\n |-- Stamina: string (nullable = true)\n |-- Standing tackle: string (nullable = true)\n |-- Strength: string (nullable = true)\n |-- Vision: string (nullable = true)\n |-- Volleys: string (nullable = true)\n |-- CAM: double (nullable = true)\n |-- CB: double (nullable = true)\n |-- CDM: double (nullable = true)\n |-- CF: double (nullable = true)\n |-- CM: double (nullable = true)\n |-- ID: integer (nullable = true)\n |-- LAM: double (nullable = true)\n |-- LB: double (nullable = true)\n |-- LCB: double (nullable = true)\n |-- LCM: double (nullable = true)\n |-- LDM: double (nullable = true)\n |-- LF: double (nullable = true)\n |-- LM: double (nullable = true)\n |-- LS: double (nullable = true)\n |-- LW: double (nullable = true)\n |-- LWB: double (nullable = true)\n |-- Preferred Positions: string (nullable = true)\n |-- RAM: double (nullable = true)\n |-- RB: double (nullable = true)\n |-- RCB: double (nullable = true)\n |-- RCM: double (nullable = true)\n |-- RDM: double (nullable = true)\n |-- RF: double (nullable = true)\n |-- RM: double (nullable = true)\n |-- RS: double (nullable = true)\n |-- RW: double (nullable = true)\n |-- RWB: double (nullable = true)\n |-- ST: double (nullable = true)\n\n+---+-----------------+---+--------------------+-----------+--------------------+-------+---------+-------------------+--------------------+------+-----+-------+------------+----------+-------+-------+------------+---------+--------+-----+---------+---------+------------------+---------+-----------+----------+--------------+-----------+----------------+-------------+-------+------------+----------+-------+---------+-----------+---------+-------------+----------+--------------+------------+-------+---------------+--------+------+-------+----+----+----+----+----+------+----+----+----+----+----+----+----+----+----+----+-------------------+----+----+----+----+----+----+----+----+----+----+----+\n|_c0|             Name|Age|               Photo|Nationality|                Flag|Overall|Potential|               Club|           Club Logo| Value| Wage|Special|Acceleration|Aggression|Agility|Balance|Ball control|Composure|Crossing|Curve|Dribbling|Finishing|Free kick accuracy|GK diving|GK handling|GK kicking|GK positioning|GK reflexes|Heading accuracy|Interceptions|Jumping|Long passing|Long shots|Marking|Penalties|Positioning|Reactions|Short passing|Shot power|Sliding tackle|Sprint speed|Stamina|Standing tackle|Strength|Vision|Volleys| CAM|  CB| CDM|  CF|  CM|    ID| LAM|  LB| LCB| LCM| LDM|  LF|  LM|  LS|  LW| LWB|Preferred Positions| RAM|  RB| RCB| RCM| RDM|  RF|  RM|  RS|  RW| RWB|  ST|\n+---+-----------------+---+--------------------+-----------+--------------------+-------+---------+-------------------+--------------------+------+-----+-------+------------+----------+-------+-------+------------+---------+--------+-----+---------+---------+------------------+---------+-----------+----------+--------------+-----------+----------------+-------------+-------+------------+----------+-------+---------+-----------+---------+-------------+----------+--------------+------------+-------+---------------+--------+------+-------+----+----+----+----+----+------+----+----+----+----+----+----+----+----+----+----+-------------------+----+----+----+----+----+----+----+----+----+----+----+\n|  0|Cristiano Ronaldo| 32|https://cdn.sofif...|   Portugal|https://cdn.sofif...|     94|       94|     Real Madrid CF|https://cdn.sofif...|€95.5M|€565K|   2228|          89|        63|     89|     63|          93|       95|      85|   81|       91|       94|                76|        7|         11|        15|            14|         11|              88|           29|     95|          77|        92|     22|       85|         95|       96|           83|        94|            23|          91|     92|             31|      80|    85|     88|89.0|53.0|62.0|91.0|82.0| 20801|89.0|61.0|53.0|82.0|62.0|91.0|89.0|92.0|91.0|66.0|             ST LW |89.0|61.0|53.0|82.0|62.0|91.0|89.0|92.0|91.0|66.0|92.0|\n|  1|         L. Messi| 30|https://cdn.sofif...|  Argentina|https://cdn.sofif...|     93|       93|       FC Barcelona|https://cdn.sofif...| €105M|€565K|   2154|          92|        48|     90|     95|          95|       96|      77|   89|       97|       95|                90|        6|         11|        15|            14|          8|              71|           22|     68|          87|        88|     13|       74|         93|       95|           88|        85|            26|          87|     73|             28|      59|    90|     85|92.0|45.0|59.0|92.0|84.0|158023|92.0|57.0|45.0|84.0|59.0|92.0|90.0|88.0|91.0|62.0|                RW |92.0|57.0|45.0|84.0|59.0|92.0|90.0|88.0|91.0|62.0|88.0|\n|  2|           Neymar| 25|https://cdn.sofif...|     Brazil|https://cdn.sofif...|     92|       94|Paris Saint-Germain|https://cdn.sofif...| €123M|€280K|   2100|          94|        56|     96|     82|          95|       92|      75|   81|       96|       89|                84|        9|          9|        15|            15|         11|              62|           36|     61|          75|        77|     21|       81|         90|       88|           81|        80|            33|          90|     78|             24|      53|    80|     83|88.0|46.0|59.0|88.0|79.0|190871|88.0|59.0|46.0|79.0|59.0|88.0|87.0|84.0|89.0|64.0|                LW |88.0|59.0|46.0|79.0|59.0|88.0|87.0|84.0|89.0|64.0|84.0|\n|  3|        L. Suárez| 30|https://cdn.sofif...|    Uruguay|https://cdn.sofif...|     92|       92|       FC Barcelona|https://cdn.sofif...|  €97M|€510K|   2291|          88|        78|     86|     60|          91|       83|      77|   86|       86|       94|                84|       27|         25|        31|            33|         37|              77|           41|     69|          64|        86|     30|       85|         92|       93|           83|        87|            38|          77|     89|             45|      80|    84|     88|87.0|58.0|65.0|88.0|80.0|176580|87.0|64.0|58.0|80.0|65.0|88.0|85.0|88.0|87.0|68.0|                ST |87.0|64.0|58.0|80.0|65.0|88.0|85.0|88.0|87.0|68.0|88.0|\n|  4|         M. Neuer| 31|https://cdn.sofif...|    Germany|https://cdn.sofif...|     92|       92|   FC Bayern Munich|https://cdn.sofif...|  €61M|€230K|   1493|          58|        29|     52|     35|          48|       70|      15|   14|       30|       13|                11|       91|         90|        95|            91|         89|              25|           30|     78|          59|        16|     10|       47|         12|       85|           55|        25|            11|          61|     44|             10|      83|    70|     11|null|null|null|null|null|167495|null|null|null|null|null|null|null|null|null|null|                GK |null|null|null|null|null|null|null|null|null|null|null|\n|  5|   R. Lewandowski| 28|https://cdn.sofif...|     Poland|https://cdn.sofif...|     91|       91|   FC Bayern Munich|https://cdn.sofif...|  €92M|€355K|   2143|          79|        80|     78|     80|          89|       87|      62|   77|       85|       91|                84|       15|          6|        12|             8|         10|              85|           39|     84|          65|        83|     25|       81|         91|       91|           83|        88|            19|          83|     79|             42|      84|    78|     87|84.0|57.0|62.0|87.0|78.0|188545|84.0|58.0|57.0|78.0|62.0|87.0|82.0|88.0|84.0|61.0|                ST |84.0|58.0|57.0|78.0|62.0|87.0|82.0|88.0|84.0|61.0|88.0|\n|  6|           De Gea| 26|https://cdn.sofif...|      Spain|https://cdn.sofif...|     90|       92|  Manchester United|https://cdn.sofif...|€64.5M|€215K|   1458|          57|        38|     60|     43|          42|       64|      17|   21|       18|       13|                19|       90|         85|        87|            86|         90|              21|           30|     67|          51|        12|     13|       40|         12|       88|           50|        31|            13|          58|     40|             21|      64|    68|     13|null|null|null|null|null|193080|null|null|null|null|null|null|null|null|null|null|                GK |null|null|null|null|null|null|null|null|null|null|null|\n|  7|        E. Hazard| 26|https://cdn.sofif...|    Belgium|https://cdn.sofif...|     90|       91|            Chelsea|https://cdn.sofif...|€90.5M|€295K|   2096|          93|        54|     93|     91|          92|       87|      80|   82|       93|       83|                79|       11|         12|         6|             8|          8|              57|           41|     59|          81|        82|     25|       86|         85|       85|           86|        79|            22|          87|     79|             27|      65|    86|     79|88.0|47.0|61.0|87.0|81.0|183277|88.0|59.0|47.0|81.0|61.0|87.0|87.0|82.0|88.0|64.0|                LW |88.0|59.0|47.0|81.0|61.0|87.0|87.0|82.0|88.0|64.0|82.0|\n|  8|         T. Kroos| 27|https://cdn.sofif...|    Germany|https://cdn.sofif...|     90|       90|     Real Madrid CF|https://cdn.sofif...|  €79M|€340K|   2165|          60|        60|     71|     69|          89|       85|      85|   85|       79|       76|                84|       10|         11|        13|             7|         10|              54|           85|     32|          93|        90|     63|       73|         79|       86|           90|        87|            69|          52|     77|             82|      74|    88|     82|83.0|72.0|82.0|81.0|87.0|182521|83.0|76.0|72.0|87.0|82.0|81.0|81.0|77.0|80.0|78.0|            CDM CM |83.0|76.0|72.0|87.0|82.0|81.0|81.0|77.0|80.0|78.0|77.0|\n|  9|       G. Higuaín| 29|https://cdn.sofif...|  Argentina|https://cdn.sofif...|     90|       90|           Juventus|https://cdn.sofif...|  €77M|€275K|   1961|          78|        50|     75|     69|          85|       86|      68|   74|       84|       91|                62|        5|         12|         7|             5|         10|              86|           20|     79|          59|        82|     12|       70|         92|       88|           75|        88|            18|          80|     72|             22|      85|    70|     88|81.0|46.0|52.0|84.0|71.0|167664|81.0|51.0|46.0|71.0|52.0|84.0|79.0|87.0|82.0|55.0|                ST |81.0|51.0|46.0|71.0|52.0|84.0|79.0|87.0|82.0|55.0|87.0|\n+---+-----------------+---+--------------------+-----------+--------------------+-------+---------+-------------------+--------------------+------+-----+-------+------------+----------+-------+-------+------------+---------+--------+-----+---------+---------+------------------+---------+-----------+----------+--------------+-----------+----------------+-------------+-------+------------+----------+-------+---------+-----------+---------+-------------+----------+--------------+------------+-------+---------------+--------+------+-------+----+----+----+----+----+------+----+----+----+----+----+----+----+----+----+----+-------------------+----+----+----+----+----+----+----+----+----+----+----+\nonly showing top 10 rows\n\nThere are 17981 rows in the fifa_df DataFrame\n"}]},"apps":[],"jobName":"paragraph_1614592636845_345035220","id":"20210301-152716_1566230592","dateCreated":"2021-03-01T15:27:16+0530","dateStarted":"2021-03-01T15:29:01+0530","dateFinished":"2021-03-01T15:29:03+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7459"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-01T15:29:01+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614592741558_-102341333","id":"20210301-152901_362981985","dateCreated":"2021-03-01T15:29:01+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:7460"}],"name":"/BDFWithPySpark/M3/SM4/Ex2","id":"2G1NA7JBG","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}