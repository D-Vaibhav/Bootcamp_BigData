{"paragraphs":[{"text":"%md\n\n# SQL queries for filtering Table\n\n- In the previous exercise, you have run a simple SQL query on a DataFrame. There are more sophisticated queries you can construct to obtain the result that you want and use it for downstream analysis such as data visualization and Machine Learning. In this exercise, we will use the temporary table `people` that you created previously and filter out the rows where the `\"sex\"` is male and female and create two DataFrames.\n\n- Remember, you already have `SparkSession` `spark` and `people` temporary table available in your workspace.\n\n## Instructions\n- Filter the `people` table to select all rows where `sex` is `female` into `people_female_df` DataFrame.\n- Filter the `people` table to select all rows where `sex` is `male` into `people_male_df` DataFrame.\n- Count the number of rows in both `people_female` and `people_male` DataFrames.","user":"anonymous","dateUpdated":"2021-03-01T14:55:31+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>SQL queries for filtering Table</h1>\n<ul>\n  <li>\n  <p>In the previous exercise, you have run a simple SQL query on a DataFrame. There are more sophisticated queries you can construct to obtain the result that you want and use it for downstream analysis such as data visualization and Machine Learning. In this exercise, we will use the temporary table <code>people</code> that you created previously and filter out the rows where the <code>&quot;sex&quot;</code> is male and female and create two DataFrames.</p></li>\n  <li>\n  <p>Remember, you already have <code>SparkSession</code> <code>spark</code> and <code>people</code> temporary table available in your workspace.</p></li>\n</ul>\n<h2>Instructions</h2>\n<ul>\n  <li>Filter the <code>people</code> table to select all rows where <code>sex</code> is <code>female</code> into <code>people_female_df</code> DataFrame.</li>\n  <li>Filter the <code>people</code> table to select all rows where <code>sex</code> is <code>male</code> into <code>people_male_df</code> DataFrame.</li>\n  <li>Count the number of rows in both <code>people_female</code> and <code>people_male</code> DataFrames.</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1614590415536_-409405482","id":"20201113-110338_1928025495","dateCreated":"2021-03-01T14:50:15+0530","dateStarted":"2021-03-01T14:55:31+0530","dateFinished":"2021-03-01T14:55:31+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5762"},{"text":"%pyspark\n\nfile_path = \"file:////home/talentum/BigDataFundamentalsWithPySpark/Dataset/people.csv\"\n\n# Create an DataFrame from file_path\n# people_df = spark.read.csv(file_path, header=True, inferSchema=True)\n\n# Create a temporary table \"people\"\npeople_df.createOrReplaceTempView(\"people\")\n\n# Filter the people table to select female sex \npeople_female_df = spark.____('SELECT * FROM ____ WHERE sex==\"____\"')\n\n# Filter the people table DataFrame to select male sex\npeople_male_df = spark.____('SELECT * ____ people ____ ____==\"____\"')\n\n# Count the number of rows in both DataFrames\nprint(\"There are {} rows in the people_female_df and {} rows in the people_male_df DataFrames\".format(people_female_df.____(), people_male_df.____()))","user":"anonymous","dateUpdated":"2021-03-01T14:50:15+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614590415582_370159923","id":"20201113-133413_165094595","dateCreated":"2021-03-01T14:50:15+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5763"},{"text":"%pyspark\n\nfile_path = \"file:////home/talentum/shared_BDVM/spark/DataSet/people.csv\"\n\npeople_df = spark.read.csv(file_path, header=True, inferSchema=True)\n\npeople_df.createOrReplaceTempView(\"people\")\n\npeople_female_df = spark.sql('select * from people where sex == \"female\"')\npeople_male_df = spark.sql('select * from people where sex == \"male\"')\n\nprint(\"There are {} rows in the people_female_df and {} rows in the people_male_df DataFrames\".format(people_female_df.count(), people_male_df.count()))","user":"anonymous","dateUpdated":"2021-03-01T14:58:23+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"There are 49014 rows in the people_female_df and 49066 rows in the people_male_df DataFrames\n"}]},"apps":[],"jobName":"paragraph_1614590755012_1724518299","id":"20210301-145555_2121917834","dateCreated":"2021-03-01T14:55:55+0530","dateStarted":"2021-03-01T14:58:23+0530","dateFinished":"2021-03-01T14:58:25+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5764"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-01T14:57:45+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614590865626_941591037","id":"20210301-145745_2034855129","dateCreated":"2021-03-01T14:57:45+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5765"}],"name":"/BDFWithPySpark/M3/SM3/Ex2","id":"2FZHFEE7A","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}