{"paragraphs":[{"text":"%md\n\n# Part 2: SQL Queries on DataFrame\n\n- The fifa_df DataFrame that we created has additional information about datatypes and names of columns associated with it. This additional information allows PySpark SQL to run SQL queries on DataFrame. SQL queries are concise and easy to run compared to DataFrame operations. But in order to apply SQL queries on DataFrame first, you need to create a temporary view of DataFrame as a table and then apply SQL queries on the created table (Running SQL Queries Programmatically).\n\n- In the second part, you'll create a temporary table of `fifa_df` DataFrame and run SQL queries to extract the `'Age'` column of players from `Germany`.\n\n- You already have a `SparkContext` `spark` and `fifa_df` available in your workspace.\n\n## Instructions\n- Create temporary table `fifa_df_table` from `fifa_df` DataFrame.\n- Construct a `\"query\"` to extract the `\"Age\"` column from Germany players.\n- Apply the SQL `\"query\"` to the temporary view table and create a new DataFrame.\n- Computes basic statistics of the created DataFrame.","user":"anonymous","dateUpdated":"2021-03-01T15:29:50+0530","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Part 2: SQL Queries on DataFrame</h1>\n<ul>\n  <li>\n  <p>The fifa_df DataFrame that we created has additional information about datatypes and names of columns associated with it. This additional information allows PySpark SQL to run SQL queries on DataFrame. SQL queries are concise and easy to run compared to DataFrame operations. But in order to apply SQL queries on DataFrame first, you need to create a temporary view of DataFrame as a table and then apply SQL queries on the created table (Running SQL Queries Programmatically).</p></li>\n  <li>\n  <p>In the second part, you&rsquo;ll create a temporary table of <code>fifa_df</code> DataFrame and run SQL queries to extract the <code>&#39;Age&#39;</code> column of players from <code>Germany</code>.</p></li>\n  <li>\n  <p>You already have a <code>SparkContext</code> <code>spark</code> and <code>fifa_df</code> available in your workspace.</p></li>\n</ul>\n<h2>Instructions</h2>\n<ul>\n  <li>Create temporary table <code>fifa_df_table</code> from <code>fifa_df</code> DataFrame.</li>\n  <li>Construct a <code>&quot;query&quot;</code> to extract the <code>&quot;Age&quot;</code> column from Germany players.</li>\n  <li>Apply the SQL <code>&quot;query&quot;</code> to the temporary view table and create a new DataFrame.</li>\n  <li>Computes basic statistics of the created DataFrame.</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1614592071548_2038241724","id":"20201113-110338_1928025495","dateCreated":"2021-03-01T15:17:51+0530","dateStarted":"2021-03-01T15:29:50+0530","dateFinished":"2021-03-01T15:29:50+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8416"},{"text":"%pyspark\n\nfile_path = \"file:////home/talentum/shared_BDVM/spark/DataSet/Fifa2018_dataset.csv\"\n\n# Load the Dataframe\nfifa_df = spark.read.csv(file_path, header=True, inferSchema=True)\n\n# Create a temporary view of fifa_df\nfifa_df.____('fifa_df_table')\n\n# Construct the \"query\"\nquery = '''SELECT ____ FROM ____ WHERE ____ == \"Germany\"'''\n\n# Apply the SQL \"query\"\nfifa_df_germany_age = spark.____(____)\n\n# Generate basic statistics\nfifa_df_germany_age.____().show()","user":"anonymous","dateUpdated":"2021-03-01T15:30:30+0530","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614592071555_753686661","id":"20201113-133413_165094595","dateCreated":"2021-03-01T15:17:51+0530","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:8417"},{"text":"%pyspark\n\nfile_path = \"file:////home/talentum/shared_BDVM/spark/DataSet/Fifa2018_dataset.csv\"\nfifa_df = spark.read.csv(file_path, header=True, inferSchema=True)\n\nfifa_df.columns\n\nfifa_df.createOrReplaceTempView('fifa_df_table')\nquery = '''select Age from fifa_df_table where Nationality == \"Germany\"'''\nfifa_df_germany_age = spark.sql(query)\n\nfifa_df_germany_age.describe().show()","user":"anonymous","dateUpdated":"2021-03-01T15:40:21+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|summary|              Age|\n+-------+-----------------+\n|  count|             1140|\n|   mean|24.20263157894737|\n| stddev|4.197096712293756|\n|    min|               16|\n|    max|               36|\n+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1614592838787_-589698815","id":"20210301-153038_1801095458","dateCreated":"2021-03-01T15:30:38+0530","dateStarted":"2021-03-01T15:35:33+0530","dateFinished":"2021-03-01T15:35:35+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8418"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-01T15:32:48+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1614592968819_1575828945","id":"20210301-153248_1278395912","dateCreated":"2021-03-01T15:32:48+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8419"}],"name":"/BDFWithPySpark/M3/SM4/Ex3","id":"2G1KYE1FD","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}